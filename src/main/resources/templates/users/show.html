<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head><th:block th:replace="fragments/head :: header('Show User')" /></head>
<body>
<nav><th:block th:replace="fragments/navbar :: navbar" /></nav>

<div class="container">
<div class="row">

    <!-- User info -->
    <div class="col s12 m6">
        <div class="card">

            <div class="card-content" style="padding-bottom: 0; padding-top: 16px;">
                <span class="card-title">
                    <span th:text="${user.username}"></span>
                </span>
                <p>
                    Email:
                    <span th:text="${user.email}"></span>
                </p>
                <p>
                    <span th:text="${user.streetAddr}"></span><br />
                    <span th:text="${user.city}"></span>,
                    <span th:text="${user.state}"></span>
                    <span th:text="${user.zipCode}"></span>
                </p>
            </div>

            <div th:if="${user.getUsername() == sessionUser.getUsername()}" class="card-action">
                <a th:href="@{'/profile/'+${user.getUsername()}+'/edit'}">
                    <i class="fas fa-user-edit"></i> Edit Profile
                </a>
                <!--<a th:href="@{'/profile/'+${user.getUsername()}+'/delete/'}">-->
                    <!--<i class="fas fa-trash-alt"></i> Delete Profile</a>-->
            </div>
        </div>
    </div> <!-- end user info -->

    <!-- children list -->
    <div th:if="${(user.getisBabysitter() == false)}" class="col s12 m6">
        <div class="card">

            <div class="card-content">
                <span class="card-title">Children:</span>
                <ul th:each="child : ${user.children}">
                    <li>
                        Name:
                        <span th:text="${child.name}"></span>
                    </li>
                    <li>
                        DOB:
                        <span th:text="${child.birthdate}"></span>
                    </li>
                    <li>
                        Notes:
                        <p>
                            <span th:text="${child.specialNote}"></span>
                        </p>
                    </li>
                    <li th:if="${user.getUsername() == sessionUser.getUsername()}" >
                        <a th:href="@{'/child/'+${child.id}+'/delete'}">
                            <i class="fas fa-trash-alt"></i> Remove child
                        </a>
                    </li>
                </ul>
            </div>

            <div  th:if="${user.getUsername() == sessionUser.getUsername()}" class="card-action">
                <a th:href="@{'/profile/'+${user.getUsername()}+'/create/children'}">
                    <i class="fas fa-plus"></i> Add a child
                </a>
            </div>
        </div>
    </div> <!-- end children list -->

    <!-- specifications stuff -->
    <div th:if="${user.getisBabysitter()}" class="col s12 m6">
        <div class="card">
            <div class="card-content">

                <span class="card-title">Specifications:</span>
                    <ul th:each="specification : ${user.specifications}">
                        <li>
                            DOB:
                            <span th:text="${specification.birthdate}"></span>
                        </li>
                        <li>
                            has cpr:
                            <span th:text="${specification.hasCprTraining}"></span>
                        </li>
                        <li>
                            is smoker:
                            <span th:text="${specification.smoker}"></span>
                        </li>
                        <li>
                            years of exp:
                            <span th:text="${specification.yearsOfExperience}"></span>
                        </li>
                        <li>
                            has transportation:
                            <span th:text="${specification.hasTransportation}"></span>
                        </li>
                    </ul>
            </div>

            <div th:if="${user.getUsername() == sessionUser.getUsername()}" class="card-action">
                <a th:href="@{'/profile/'+${user.getUsername()}+'/edit/specifications'}">
                    <i class="fas fa-user-edit"> Edit Specifications</i>
                </a>
            </div>
        </div>
    </div> <!-- end specs stuff -->

</div> <!-- end row 1 -->


<div class="row">

    <!-- parent appointments -->
    <div th:if="${(user.getisBabysitter() == false)}" class="col s12 m6">
        <div class="card">
            <div class="card-content">

                <span class="card-title">Future Appointments: </span>

                <ul th:each="appt : ${parentAppointments}">
                    <li th:if="${(user.getisBabysitter() == false)}" style="list-style: none; display: inline;">
                        Babysitter name:
                        <a th:href="@{'/profile/' + ${appt.getBabysitter().getUsername()}}">
                        <span th:text="${appt.getBabysitter().getUsername()}"></span></a>
                    </li>
                    <li>
                        Start:
                        <span th:text="${appt.start}"></span>
                    </li>
                    <li>
                        End:
                        <span th:text="${appt.end}"></span>
                    </li>
                    <li th:if="${user.getUsername() == sessionUser.getUsername()}">
                        <a th:href="@{'/profile/'+${user.getUsername()}+'/delete/appointment/'+${appt.getId()}}">
                            <i class="fas fa-trash-alt"></i> Cancel Appointment
                        </a>
                    </li>
                </ul>
            </div>

            <div class="card-action">
                <a th:href="@{'/appointments/create'}">
                <i class="fas fa-plus"></i> Schedule New Appointment</a>
            </div>
        </div>
    </div> <!-- end parent appts -->

    <!-- babysitter appointments -->
    <div th:if="${(user.getisBabysitter() == true) and user.getUsername() == sessionUser.getUsername()}" class="col s12 m6">
        <div class="card">
            <div class="card-content">

                <span class="card-title">Future Appointments: </span>

                <ul th:each="appt : ${babysitterAppointments}"  style="list-style: none; display: inline;">
                     <li th:if="${(user.getisBabysitter() == true)}">
                        Parent:
                        <a th:href="@{'/profile/' + ${appt.getParent().getUsername()}}">
                            <span th:text="${appt.getParent().getUsername()}"></span>
                        </a>
                    </li>
                    <li th:if="${(user.getisBabysitter() == false)}">
                        Babysitter name: <span th:text="${appt.getBabysitter().getUsername()}"></span>
                    </li>
                    <li>
                        Start:
                        <span th:text="${appt.start}"></span>
                    </li>
                    <li>
                        End:
                        <span th:text="${appt.end}"></span>
                    </li>
                    <li th:if="${user.getUsername() == sessionUser.getUsername()}">
                        <a th:href="@{'/profile/'+${user.getUsername()}+'/delete/appointment/'+${appt.getId()}}">
                            <i class="fas fa-trash-alt"></i> Cancel Appointment
                        </a>
                    </li>
                </ul>
            </div>

        </div>
    </div> <!-- end babysitter appts -->

    <!-- Available Times List -->
    <div th:if="${(user.getisBabysitter() == true)}" class="col s12 m6">
        <div class="card">
            <div class="card-content">

                <span class="card-title">Available Hours:</span>

                    <ul th:each="time : ${available_times}"  style="list-style: none; display: inline;">
                        <li th:if="${time.getBabysitter().getId() == user.getId() and time.start > current_time}"
                           class="col s12">
                        </li>
                        <li class="card-title">
                            From: <span th:text="${time.start}"></span>
                            <br />
                            To: <span th:text="${time.end}"></span>
                        </li>
                        <li>
                            <a th:if="${user.getUsername() == sessionUser.getUsername()}"
                               th:href="@{'/available-times/'+${time.getId()}+'/delete/'}">
                                <i class="fas fa-trash-alt"></i> Cancel Time Slot
                            </a>
                        </li>
                    </ul>
            </div>

            <div th:if="${user.getUsername() == sessionUser.getUsername()}" class="card-action">
                <a th:href="@{'/available-times/create'}">
                    <i class="fas fa-plus"></i> Schedule Available Hours</a>
            </div>
        </div>
    </div> <!-- end avail times -->

</div> <!-- end row 2 -->


<div class="row">

    <!-- reviews made by parent list -->
    <div th:if="${(user.getisBabysitter() == false)}" class="col s12">
        <div class="card">
            <div class="card-content">

                <span class="card-title">Reviews made:</span>

                <ul th:each="review : ${user.reviews}">
                    <li style="list-style: none;">
                        <a th:href="@{'/reviews/' + ${review.id}}">
                            <span th:text="${review.title}"></span>
                        </a>
                    </li>
                    <li>
                        Sitter:
                        <a th:href="@{'/reviews/' + ${review.id}}">
                            <span th:text="${review.babysitter.getUsername()}"></span>
                        </a>
                    </li>
                    <li th:if="${user.getUsername() == sessionUser.getUsername()}">
                        <a href="#">
                            <i class="fas fa-user-edit"></i> Edit Review
                        </a>
                        <a href="#">
                            <i class="fas fa-trash-alt"></i> Delete Review
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div> <!-- end reviews made -->

    <!-- Reviews on babysitters List -->
    <div th:if="${(user.getisBabysitter() == true)}" class="col s12">
        <div class="card">
            <div class="card-content">

                <span class="card-title">Reviews: </span>

                <div th:each="review : ${reviews}"
                     th:if="${review.getBabysitter().getUsername() == user.getUsername()}" class="card-panel">

                    <ul>
                        <li style="list-style: none; display: inline;">
                            Author:
                            <a th:href="@{'/reviews/' + ${review.id}}">
                                <span th:text="${review.getParent().getUsername()}"></span>
                            </a>
                        </li>
                        <li>
                            Title:
                            <span th:text="${review.getTitle()}"></span>
                        </li>
                        <li>
                            <span th:text="${review.getBody()}"></span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div> <!-- end babysitters reviews -->


</div> <!-- end row 3 -->
</div> <!-- end container -->
<footer><th:block th:replace="fragments/footer :: footer"/></footer>
<th:block th:replace="fragments/includes :: includes" />
</body>
</html>